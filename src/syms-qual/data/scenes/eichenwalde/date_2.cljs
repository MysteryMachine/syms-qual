(ns syms-qual.data.scenes.eichenwalde.date-2
  (:require [carmen.util :as anim :refer [scoot]]))

(def data
  {[:objective :pharah 5]
   [:miranda/dialogue
    ["Ana" [[:reinhardt :_neutral (scoot -26 -15 1)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_wave (scoot -87 -17 1)]]
     "Fareeha."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
               [:pharah :_reverseSalute (scoot 10)] [:symmetra :_neutral (scoot 10)]
               [:ana :_neutral (scoot -17)]]
     "Yes, ma’am?"]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_smile (scoot 10)]
            [:ana :_wave (scoot -17)]]
     "At ease, soldier. I’ve come to apologize for lashing out. I was frustrated about something else, and I lashed out at you. It was unfair to you, and inappropriate from a superior officer."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
               [:ana :_neutral (scoot -17)]
               [:pharah :_reverseExplainUnsure (scoot 10)] [:symmetra :_neutral (scoot 10)]]
     "Mama."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_explain (scoot -17)]]
     "I've been struggling to deal with the fact that Overwatch is different now than it was in the past. I don't want to be the hardass who enforces strict discipline on these drills. They are of questionable usefulness, and I get why people are goofing off."]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
                 [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_explainUncomfortable (scoot 10)]
                 [:ana :_cranky (scoot -17)]]
     "Overwatch has a UN sanction. I hardly think they would have chosen to support us if they did not believe the program to be worthwhile."]
    ["Ana" [[:reinhardt :_wince (scoot -15)]
            [:pharah :_reverseCold (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_roll-eyes (scoot -17)]]
     "Ah, yes. UN saction. At least we have that."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
               [:ana :_drink (scoot -17)]
               [:pharah :_reverseExplainGlare (scoot 10)] [:symmetra :_neutral (scoot 10)]]
     "Mama, be nice."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_sassTalk (scoot -17)]]
     "Sorry, 'ibna. Anyway, I don’t blame you for taking a break. Even if Winston does."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
               [:pharah :_reverseExplain (scoot 10)] [:symmetra :_smile (scoot 10)]
               [:ana :_sass (scoot -17)]]
     "At least this family can agree Winston is meta scum."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_sass (scoot 10)]
            [:ana :_drink (scoot -17)]]
     "Absolutely, darling. Why will he not let us snipe in peace?"]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
                 [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_explainUncomfortable (scoot 10)]
                 [:ana :_neutral (scoot -17)]]
     "I could not agree more. What a try hard."]
    [nil [[:reinhardt :_laugh (scoot -15)]
          [:pharah :_reverseLaugh (scoot 10)] [:symmetra :_laugh (scoot 10)]
          [:ana :_laugh (scoot -17)]]
     "You all share a hearty chortle."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_smile (scoot 10)]
            [:ana :_sassTalk (scoot -17)]]
     "Shall we get dinner, everyone?"]
    ["Reinhardt" [[:reinhardt :_pointUp (scoot -15)]
                  [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
                  [:ana :_neutral (scoot -17)]]
     "I know a currywurst place we can go to!"]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_smile (scoot 10)]
            [:ana :_drink (scoot -17)]]
     "That sound good to everyone?"]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
                 [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_pointUp (scoot 10)]
                 [:ana :_neutral (scoot -17)]]
     "I, for one, do not wish to have the worst curry."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
               [:pharah :_reverseExplainBack (scoot 10)] [:symmetra :_smile (scoot 10)]
               [:ana :_neutral (scoot -17)]]
     "Symmetra, no it’s--"]
    ["Ana" [[:reinhardt :_wince (scoot -15)]
            [:pharah :_reverseAnguish (scoot 10)] [:symmetra :_laugh (scoot 10)]
            [:ana :_explain (scoot -17)]]
     "She is making a joke, darling, don’t correct her."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
               [:pharah :_reverseEmbarassed (scoot 10)] [:symmetra :_smile (scoot 10)]
               [:ana :_sass (scoot -17)]]
     "Ah. Okay. Currywurst then!"]
    :-> [:beer-hall :pharah :cutscene 3]]

   [:beer-hall :pharah :cutscene 3]
   [:miranda/narration
    "You arrive at the beer hall, and they do not seem to be happy to have two people in power armor patronizing their restaurant. The old floorboards creak audibly under the immense weight of your party and the manager seems quite concerned. A vengeful glare from Ana cuts short any commentary the waitstaff might have had and they resign themselves to their fates.  After some more bad puns, Reinhardt orders a currywurst and a pint for everyone."
    :-> [:beer-hall :pharah 6]]

   [:beer-hall :pharah 6]
   [:miranda/dialogue
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Reinhardt, you did not even ask Satya if she drinks or not."]
    :-> [:beer-hall :pharah :option 3]]

   [:beer-hall :pharah :option 3]
   [:miranda/option
    "Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
    "I will accept the drink, thank you."
    "No thank you, I do not drink."]

   [:beer-hall :pharah :option 3 0]
   [:miranda/dialogue
    ["Reinhardt" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Prost!"]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Prost, everyone."]
    :-> [:beer-hall :pharah 7]]

   [:beer-hall :pharah :option 3 1]
   [:miranda/dialogue
    ["Reinhardt" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "See, here, Ana, you will learn of the brilliance of the Reinhardt system. You order a beer without asking, and if they say no, now you are a beer richer. Prost!"]
    :-> [:beer-hall :pharah 7]]

   [:beer-hall :pharah 7]
   [:miranda/dialogue
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Reinhardt, do not get drunk in that power armor, you will literally die."]
    ["Reinhardt" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "I do not fear death!"]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "I’ll drink to that."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "‘Ibna, I understand we just had a reconciliatory moment but please do not terrify your mama by getting drunk in power armor."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Affirmative, ma’am."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Good. I have a breathalyzer just for these occasions. When you learn to keep one on you when getting drunk with brutes in power armor."]
    ["Reinhardt" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "You get drunk in well polished, durasteel, hydraulic power armor once in your late twenties, and suddenly one can never be trusted again."]
    ["Ana" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Ruining people’s fun by carrying a breathalyzer at all times is my specific brand of comedy. And you didn’t just get drunk. You got drunk and tried to race a train by rocket charging on the train tracks."]
    ["Reinhardt" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "But you are leaving out the important part! Which is that I won!"]
    ;You and Pharah start whispering to each other on your edge of the table.
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Think we’re finally free of the nagging? I have heard this story so many times. It goes on for a while."]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "I think they are adorable."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Give it a few more months, and we’ll see you how you feel."]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Of course."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "But it’s good to have her talking to me like this. Being treated like a soldier’s all I ever wanted."]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Well, if you want to be treated like a soldier, then you best prepare to pass that breathalyzer. "]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Oh geez, not you too!"]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "I’ll do it if you do it."]
    :transition :miranda/conditional
    [#(> (:points/pharah %) 0)  [:-> [:beer-hall :pharah :date :cutscene 4]]
     :else                      [:-> [:beer-hall :pharah :cutscene :not-date :final]]]]

   [:beer-hall :pharah :date :cutscene 4]
   [:miranda/narration
    "You enjoy the rest of the evening, listen to Reinhardt’s old stories, and Pharah and Ana’s amusing interjections.  As the evening draws to a close, the four of you make your way outside to begin the trek back to your nearby hotel. Before you set out, Ana insists on breathalyzing Reinhardt despite that fact that he ultimately only had two beers. After examining, the results she passes the breathalyzer to Pharah, who shoots you a playful glance before stepping in to have her turn as well. She and Ana exchange a smile, and Ana applies the test. Pharah hands you the breathalyzer."
    :-> [:beer-hall :pharah :date 5]]

   [:beer-hall :pharah :date 5]
   [:miranda/dialogue
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Your turn!"]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "You want me to blow into this thing?"]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Something like that! Strike a pose!"]
    ["Symmetra" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]] "Fine."]
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "Hehe. Get closer!"]
    ;Pharah snaps a selfie.
    ["Pharah" [[:reinhardt :_neutral (scoot -15)]
            [:pharah :_reverseNeutral (scoot 10)] [:symmetra :_neutral (scoot 10)]
            [:ana :_neutral (scoot -17)]]
     "What is your phone number?"]
    :-> [:beer-hall :pharah :cutscene :date :final]]

   [:beer-hall :pharah :cutscene :date :final]
   [:miranda/narration
    "Pharah walks you home. She nervously leaves you at the door, turning beet red at the last minute, freezing up. You wave her goodnight and blow a kiss. A few minutes after, a text message arrives on your phone; Pharah had sent you the breathalyzer selfie as memento.
"
    :=> [:junkertown [:spawn :intro] 0]]

   [:spawn :pharah :cutscene :not-date :final]
   [:miranda/narration
    "You enjoy the rest of the evening, listening to Reinhardt’s old stories and Pharah and Ana’s amusing interjections. As the evening draws to a close, the four of you make your way outside to begin the trek back to your nearby hotel. Before you set out, Ana insists on breathalyzing Reinhardt despite that fact that he ultimately only had two beers. Afterwards, she passes the breathalyzer to Pharah, requesting that she take the test as well. She and Ana exchange a smile, and Ana applies the test. Once she is satisfied with the results, you head back to the hotel listening to one last story from Reinhardt as you walk. "
    :=> [:junkertown [:spawn :intro] 0]]})
